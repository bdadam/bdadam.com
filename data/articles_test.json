{
  "adding-tab-support-to-textareas": {
    "layout": "post.hbs",
    "date": "2014-01-30 23:56",
    "title": "Adding tab support to textareas",
    "description": "Some example JavaScript code which detects when user presses TAB or SHIFT+TAB",
    "abstract": "Have you ever wondered how is it possible to support tabs in a textarea? Normally when you press the tab key, the focus jumps to the next element. But with some JavaScript 'magic' it's possible to indent or unindent the text.",
    "tags": [
      "javascript",
      "browser"
    ],
    "preview": "The code detects when the user presses TAB or SHIFT+TAB - the current line gets indented or unindented.\r\nSource code for the example can be found here: <a href=\"https://gist.github.com/bdadam/8721698\" rel=\"external,nofollow\">gist.github.com/bdadam/8721698</a>.\r\n\r\n```html\r\n<!doctype html>\r\n<html>\r\n<head>\r\n    <meta name=\"charset\" content=\"utf-8\"/>\r\n    <title></title>\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\"/>\r\n    <meta name=\"author\" content=\"Adam Beres-Deak\"/>\r\n    <meta name=\"viewport\" content=\"width=device-width\"/>\r\n    <style>\r\n    \tbody {\r\n    \t\tpadding: 40px;\r\n    \t}\r\n    \ttextarea {\r\n    \t\twidth: 100%;\r\n    \t\theight: 350px;\r\n    \t\tfont-family: CourierNew, Courier;\r\n    \t}\r\n    </style>\r\n</head>\r\n<body>\r\n\t<textarea id=\"tx\"></textarea>\r\n\t<script>\r\n\tfunction enableTab(id) {\r\n\t\tvar shiftPressed = false;\r\n\t\tvar ctrlPressed = false;\r\n\t\tvar tabChar = '    ';\r\n\r\n\t\tfunction checkSpecialKeys(e) {\r\n\t\t\tswitch(e.keyCode) {\r\n\t\t\t\tcase 16:\r\n\t\t\t\t\tshiftPressed = !shiftPressed;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 17:\r\n\t\t\t\t\tctrlPressed = !ctrlPressed;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdocument.addEventListener('keydown', checkSpecialKeys);\r\n\t\tdocument.addEventListener('keyup', checkSpecialKeys);\r\n\r\n\t\tfunction addTab(textarea) {\r\n\t\t\t// caching some values, because they are changing as text changes\r\n            var value = textarea.value,\r\n                start = textarea.selectionStart,\r\n                end = textarea.selectionEnd;\r\n\r\n            // adding tab character to actual cursor position\r\n            textarea.value = value.substring(0, start) + tabChar + value.substring(end);\r\n\r\n            // putting cursor back to its original position\r\n            textarea.selectionStart = textarea.selectionEnd = start + tabChar.length;\r\n\t\t}\r\n\r\n\t\tfunction removeTab(textarea) {\r\n\t\t\tvar curPos = textarea.selectionStart,\r\n\t\t\t\tlines = textarea.value.split('\\n'),\r\n\t\t\t\tnewValue = '',\r\n\t\t\t\tdone = false,\r\n\t\t\t\tcnt = 0;\r\n\r\n\t\t\tfor (var i = 0, l = lines.length; i < l; i++) {\r\n\t\t\t\t// iterating through each line\r\n\t\t\t\tvar line = lines[i];\r\n\t\t\t\tcnt += line.length;\r\n\t\t\t\tif (cnt >= curPos && !done) {\r\n\t\t\t\t\t// cursor is in this line\r\n\t\t\t\t\tvar newLine = line.replace(new RegExp('^' + tabChar, ''), '');\r\n\r\n\t\t\t\t\tif (newLine !== line) {\r\n\t\t\t\t\t\t// there was a tab at the beginning of the line, replace was succesfull, cursor must be moved backwards some\r\n\t\t\t\t\t\tline = newLine;\r\n\t\t\t\t\t\tcurPos -=tabChar.length;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdone = true; // only one substitution per run\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnewValue += line + '\\n';\r\n\t\t\t}\r\n\r\n\t\t\t// setting new value\r\n\t\t\ttextarea.value = newValue;\r\n\r\n\t\t\t// putting cursor back to its original position\r\n\t\t\ttextarea.selectionStart = textarea.selectionEnd = curPos;\r\n\t\t}\r\n\r\n\t    var textArea = document.getElementById(id);\r\n\t    textArea.addEventListener('keydown', function(e) {\r\n\t        if (e.keyCode === 9) {\r\n\r\n\t        \tif (!shiftPressed) {\r\n\t            \taddTab(this);\r\n\t            } else {\r\n\t            \tremoveTab(this);\r\n\t            }\r\n\r\n\t            return false; // preventing losing focus\r\n\t        }\r\n\t    });\r\n\t}\r\n\r\n\tenableTab('tx');\r\n\t</script>\r\n</body>\r\n```",
    "iso8601Date": "2014-01-30T23:56:00+01:00",
    "basename": "adding-tab-support-to-textareas"
  }
}
