<!doctype html>
<html>
<head>
    <meta name="charset" content="utf-8"/>
    <title>Strong caching with NGINX</title>
    <meta name="description" content="Enabling strong caching for assets is very important, here is an example how to do it with nginx for static files"/>
    <meta property="og:description" content="Strong caching is very important nowadays since it can reduce page load times for the users (and eventually it can also reduce network transfer costs for the publishers). Here we see a simple example how to do it with NGINX for static files like css, JavaScript and images."/>
    <link href="/static/main.css?b5e2d1a1" rel="stylesheet"/>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/bdadamcom"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="author" content="Adam Beres-Deak"/>
    <meta name="viewport" content="width=device-width"/>
    <script src="/static/main.js?1655fbc9" async></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favico/apple-touch-icon-57x57.png"/>
<link rel="apple-touch-icon" sizes="114x114" href="/static/img/favico/apple-touch-icon-114x114.png"/>
<link rel="apple-touch-icon" sizes="72x72" href="/static/img/favico/apple-touch-icon-72x72.png"/>
<link rel="apple-touch-icon" sizes="144x144" href="/static/img/favico/apple-touch-icon-144x144.png"/>
<link rel="apple-touch-icon" sizes="60x60" href="/static/img/favico/apple-touch-icon-60x60.png"/>
<link rel="apple-touch-icon" sizes="120x120" href="/static/img/favico/apple-touch-icon-120x120.png"/>
<link rel="apple-touch-icon" sizes="76x76" href="/static/img/favico/apple-touch-icon-76x76.png"/>
<link rel="apple-touch-icon" sizes="152x152" href="/static/img/favico/apple-touch-icon-152x152.png"/>
<link rel="icon" type="image/png" href="/static/img/favico/favicon-196x196.png" sizes="196x196"/>
<link rel="icon" type="image/png" href="/static/img/favico/favicon-160x160.png" sizes="160x160"/>
<link rel="icon" type="image/png" href="/static/img/favico/favicon-96x96.png" sizes="96x96"/>
<link rel="icon" type="image/png" href="/static/img/favico/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="/static/img/favico/favicon-16x16.png" sizes="16x16"/>
<meta name="msapplication-TileColor" content="#aa2211"/>
<meta name="msapplication-TileImage" content="/static/img/favico/mstile-144x144.png"/>
</head>
<body>
<nav>
    <div class="container">
        <div class="pull-right">
            <a href="/">Home</a>
            
            <a href="/about.html">Contact</a>
        </div>
        <a class="brand" href="/">bdadam.com</a>
    </div>
</nav>


<div class="container">
    <article class="full-post">
        <h1>Strong caching with NGINX</h1>
        <p class="legal">
            2nd February 2014
            | by <a href="/about.html">Adam Beres-Deak</a>
            
                | <i class="fa fa-tags"></i> nginx,  caching 
            
        </p>
        <p class="share-bar"></p>

        <p>Strong caching is very important nowadays since it can reduce page load times for the users (and eventually it can also reduce network transfer costs for the publishers). Here we see a simple example how to do it with NGINX for static files like css, JavaScript and images.</p>


        <pre><code class="language-nginx">server {
    location ~* \.(?:ico|css|js|gif|jpe?g|png)$ {
        root /var/www/mysite;
        expires max;
        add_header Cache-Control &quot;public&quot;;
        access_log off;
        break;
    }
}</code></pre>
<p>Of course after modifying the config file we have to reload the configs (e. g. on Ubuntu we have to type <code>sudo /etc/init.d/nginx reload</code>)</p>
<p>There are a few things to note here:</p>
<ul>
<li>we set the &quot;expires&quot; header to max age, which means these resources can stay in the browser cache &#39;forever&#39;</li>
<li>we are setting the &quot;Cache-Control&quot; header to &quot;public&quot;, which means that the resource &quot;may be cached in public shared caches&quot;</li>
<li>we turn off access logging here, because these requests are in many cases not that important</li>
<li>if you set expiration to max-age, you have to be sure that the requested resources really never change (some kind of cache busting)</li>
<li>these settings can live in the <code>location</code> section or in the <code>server</code> section of an nginx config file</li>
</ul>
<p>Have you already enabled strong caching for yout asset files?</p>
<p><strong> Update:</strong>
Maybe you noticed the lookahead in the regex.
It has a reason to be there: this way the regex engine doesn&#39;t create a capture group (no $1) so it has better performance.</p>


        <p class="share-bar"></p>
        <a id="comments"></a>
        <div id="disqus_thread"></div>
        <script>
            var disqus_shortname = 'bdadamcom';
            (function() {
                var d = document.createElement('script'); d.async = true;
                d.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(d, s);
            }());
        </script>
    </article>

    <h4>Latest blog posts</h4>
    
        
            <p><a href="/blog/comparison-helper-for-handlebars.html">Comparison helper for Handlebars.js <span class="muted"><small>13th February 2014</small></span></a></p>
        
    
        
            <p><a href="/blog/one-more-reason-to-check-for-strict-equality-in-javascript.html">One more reason to check for strict equality in JavaScript <span class="muted"><small>12th February 2014</small></span></a></p>
        
    
        
            <p><a href="/blog/finally-always-wins-unless-you-crash-your-computer-meanwhile.html">Finally always wins, unless you crash your computer meanwhile <span class="muted"><small>11th February 2014</small></span></a></p>
        
    
        
            <p><a href="/blog/strange-error-when-installing-npm-package-globally-on-ubuntu.html">Strange error when installing npm package globally on Ubuntu <span class="muted"><small>10th February 2014</small></span></a></p>
        
    
        
            <p><a href="/blog/defining-properties-in-javascript.html">Defining properties in JavaScript <span class="muted"><small>9th February 2014</small></span></a></p>
        
    
</div>

<footer>
    <p>Adam Beres-Deak &copy; 2014 | <a rel="external" href="http://feeds.feedburner.com/bdadamcom">RSS</a></p>
    <p class="legal container">
        Except where otherwise noted, content on this site is licensed under a
        <a href="http://creativecommons.org/licenses/by/4.0/" rel="external,noindex,nofollow">Creative Commons Attribution 4.0 International license</a>.
        Code samples are licensed under the MIT license.
    </p>
</footer>
</body>
</html>